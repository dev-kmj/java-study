# ğŸ“Œ ì“°ë ˆë“œ(Thread)

### ìë°”ì—ì„œì˜ ë©€í‹°ìŠ¤ë ˆë”©
ìë°”ì—ì„œëŠ” ì–¸ì–´ ìì²´ì— ë‹¤ì¤‘ ìŠ¤ë ˆë”© ê¸°ëŠ¥ì´ ë‚´ì¥ë˜ì–´ ìˆë‹¤. ê·¸ë¦¬ê³  ìƒˆë¡œìš´ ì‹¤í–‰ ìŠ¤ë ˆë“œë¥¼ ë§Œë“œëŠ” ë°©ë²•ë„ ì•„ì£¼ ê°„ë‹¨í•˜ë‹¤.
```java
Thread t = new Thread();
t.start();
```
ì´ ì½”ë“œê°€ ì „ë¶€ì´ë‹¤.

### í•œ ê°€ì§€ ë¬¸ì œì ì´ ìˆë‹¤.
ì¤‘ìš”í•œ êµ¬ì„±ìš”ì†Œ í•œ ê°€ì§€ê°€ ë¹ ì ¸ ìˆëŠ”ë° ë°”ë¡œ ì‘ì—…(job)ì´ë‹¤. ì¦‰, ë³„ë„ì˜ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ì‹œí‚¬ ì½”ë“œê°€ í•„ìš”í•˜ë‹¤. ìë°”ì—ì„œ ë‹¤ì¤‘ ìŠ¤ë ˆë”©ì„ ì‚¬ìš©í•˜ë ¤ë©´ ìŠ¤ë ˆë“œì™€ ê·¸ ìŠ¤ë ˆë“œì— ì˜í•´ ì‹¤í–‰ë˜ëŠ” ì‘ì—…ì— ëª¨ë‘ ì‹ ê²½ì„ ì¨ì•¼ í•œë‹¤.

### ìë°”ì—ì„œëŠ” ìŠ¤ë ˆë“œ ì—¬ëŸ¬ ê°œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ Thread í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ë¿ì´ë‹¤.
**ìŠ¤ë ˆë“œ**ë¼ê³  ê·¸ëƒ¥ í•œê¸€ë¡œ ì“¸ ë•Œë„ ìˆê³ , **Thread**ë¼ê³  ëŒ€ë¬¸ìë¡œ ì‹œì‘í•´ì„œ ì“°ëŠ” ê²½ìš°ë„ ìˆë‹¤.
- **ìŠ¤ë ˆë“œ**
  - ìŠ¤ë ˆë“œëŠ” ë³„ë„ì˜ ì‹¤í–‰ ìŠ¤ë ˆë“œë¥¼ ì§€ì¹­í•œë‹¤. ì¦‰, ë³„ë„ì˜ í˜¸ì¶œ ìŠ¤íƒì„ ì˜ë¯¸í•˜ëŠ” ê²ƒì´ë‹¤. ëª¨ë“  ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ë©”ì¸ ìŠ¤ë ˆë“œë¥¼ ì‹œì‘í•œë‹¤. ê·¸ë¦¬ê³  í”„ë¡œê·¸ë˜ë¨¸ë“¤ì´ ë‹¤ë¥¸ ìŠ¤ë ˆë“œë¥¼ ì‹œì‘ì‹œí‚¤ëŠ” ì½”ë“œë¥¼ ì§ì ‘ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤.

- **Thread**
  - ThreadëŠ” ì‹¤í–‰ ìŠ¤ë ˆë“œë¥¼ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ì´ë‹¤. ìŠ¤ë ˆë“œë¥¼ ì‹œì‘ì‹œí‚¤ê³  í•œ ìŠ¤ë ˆë“œë¥¼ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì™€ ê²°í•©ì‹œí‚¤ê³  ìŠ¤ë ˆë“œë¥¼ ëŒ€ê¸° ìƒíƒœë¡œ ëŒë¦¬ëŠ” ë©”ì„œë“œ ë“±ì´ ë“¤ì–´ ìˆë‹¤.

### í˜¸ì¶œ ìŠ¤íƒì´ ë‘ ê°œ ì´ìƒ ìˆë‹¤ëŠ” ê²ƒì€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ë‚˜ìš”?
í˜¸ì¶œ ìŠ¤íƒì´ ë‘ ê°œ ì´ìƒ ìˆìœ¼ë©´ ì—¬ëŸ¬ ê°€ì§€ê°€ ë™ì‹œì— ì¼ì–´ë‚˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. 

- ìŠ¤ë ˆë“œì—ì„œ í•´ì•¼ í•˜ëŠ” ì¼ ì¤‘ì—ëŠ” ìŠ¤ë ˆë“œì˜ ìŠ¤íƒì—ì„œ í˜„ì¬ (ì–´ë–¤ ë©”ì„œë“œì— ë“¤ì–´ ìˆëŠ”) ì–´ë–¤ ëª…ë ¹ë¬¸ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ë¥¼ ì¶”ì í•˜ëŠ” ì‘ì—…ë„ í¬í•¨ë˜ì–´ ìˆë‹¤.
  - â‘  JVMì—ì„œ main() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤.
    ```java
    public static void main(String[] agrs) {
    ...
    }
    ```
    - ë©”ì¸ ìŠ¤ë ˆë“œ : `main()`

  - â‘¡ main()ì—ì„œ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œë¥¼ ì‹œì‘í•œë‹¤. ìƒˆë¡œìš´ ìŠ¤ë ˆë“œê°€ ì‹œì‘ë  ë•Œê¹Œì§€ ë©”ì¸ ìŠ¤ë ˆë“œëŠ” ì¼ì‹œì ìœ¼ë¡œ ë©ˆì¶˜ë‹¤.
    ```java
    Runnable r = new MyThreadJob();
    Thread t = new Thread(r);
    t.start();
    Dog d = new Dog();
    ```
    - ë©”ì¸ ìŠ¤ë ˆë“œ : `t.start()`, `main()`
    - ì‚¬ìš©ì ìŠ¤ë ˆë“œ 't' : `run()`

  - â‘¢ JVMì—ì„œëŠ” ë‘ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œ(ì‚¬ìš©ì ìŠ¤ë ˆë“œ 't')ì™€ ì›ë˜ì˜ ë©”ì¸ ìŠ¤ë ˆë“œ ì‚¬ì´ë¥¼ ì™”ë‹¤ ê°”ë‹¤ í•œë‹¤.
    - ë©”ì¸ ìŠ¤ë ˆë“œ : `Dog()`, `main()`
    - ì‚¬ìš©ì ìŠ¤ë ˆë“œ 't' : `x.go()`, `run()`
   

### ìƒˆë¡œìš´ í˜¸ì¶œ ìŠ¤íƒì„ ìƒì„±í•˜ë ¤ë©´ ì‹¤í–‰ì‹œí‚¬ ì‘ì—…ì´ í•„ìš”í•˜ë‹¤

ìƒˆ í˜¸ì¶œ ìŠ¤íƒì„ ì‹œì‘í•˜ë ¤ë©´ ì‘ì—…ì´ í•„ìš”í•˜ë‹¤. ê·¸ ì‘ì—…ì€ ì‚¬ì‹¤ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œì˜ ìŠ¤íƒì— ë“¤ì–´ê°€ëŠ” ì²« ë²ˆì§¸ ë©”ì„œë“œì´ë©° ë°˜ë“œì‹œ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœì˜ ë©”ì„œë“œì—¬ì•¼ë§Œ í•œë‹¤.
```java
public void run() {
  // ìƒˆë¡œìš´ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ì‹œí‚¬ ì½”ë“œ
}
```
- ìŠ¤ë ˆë“œì—ì„œ í•  ì‘ì—…ì€ Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ë¡œ, ë˜ëŠ” run ë©”ì„œë“œì— ë§ëŠ” ëª¨ì–‘ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ëŒë‹¤ í‘œí˜„ì‹ìœ¼ë¡œ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
- Runnableê³¼ ìŠ¤ë ˆë“œì˜ ê´€ê³„ëŠ” ì‘ì—…ê³¼ ì¼ê¾¼ ì‚¬ì´ì˜ ê´€ê³„ì™€ ê°™ë‹¤. Runnable ê°ì²´ì— ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ì‹œí‚¬ ì‘ì—…ì´ ë“¤ì–´ ìˆë‹¤. ê°ì²´ì—ëŠ” ìƒˆë¡œìš´ ìŠ¤ë ˆë“œ ìŠ¤íƒì˜ ë§¨ ë°‘ì— ë“¤ì–´ê°€ëŠ” run()ì´ë¼ëŠ” ë©”ì„œë“œê°€ ë“¤ì–´ ìˆë‹¤.

### ìŠ¤ë ˆë“œì—ì„œ í•  ì¼ì„ ë§Œë“¤ë ¤ë©´ Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ë¼
```java
public class MyRunnable implements Runnable {
  public void run() {  // ì—¬ê¸°ì— ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰í•  ì‘ì—…ì„ ì§‘ì–´ë„£ëŠ”ë‹¤.
    go();  
  }

  public void go() {
    doMore();
  }

  public void doMore() {
    System.out.println(Thread.currentThread().getName() + ": top o' the stack");
    Thread.dumpStack();
  }
}
```
- Runnableì€ `java.lang`íŒ¨í‚¤ì§€ì— ìˆê¸° ë•Œë¬¸ì— import êµ¬ë¬¸ì´ ì—†ì–´ë„ ë¨
- Runnableì—ëŠ” êµ¬í˜„í•  ë©”ì„œë“œê°€ `public ovid run()` í•˜ë‚˜ë¿ì„
- dumpStackì—ì„œëŠ” ì˜ˆì™¸ ìŠ¤íƒ ì¶”ì ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ í˜„ì¬ í˜¸ì¶œ ìŠ¤íƒì„ ì¶œë ¥í•´ì¤Œ


### í•œ ê°€ì§€ ì‘ì—… ì‹¤í–‰í•˜ê¸°
ë©”ì¸ í´ë˜ìŠ¤ ì™¸ì— ë”± í•œ ì‘ì—…ë§Œ ì‹¤í–‰í•´ë³´ì. ì´ëŸ° ê²½ìš°ì—ëŠ” ë‹¨ì¼ ìŠ¤ë ˆë“œ ì‹¤í–‰ê¸°(single thread executor)ë¥¼ ì“¸ ìˆ˜ ìˆë‹¤.
```java
class ExecutorTester {
  public static void main(String[] args) {
    Runnable job = new MyRunnable();
    ExecutorService executor = Executors.newSingleThreadExecutor();
    executor.execute(job);  // ExecutorServiceì— ì‘ì—…ì„ ì‹¤í–‰í•˜ë¼ê³  ì•Œë¦°ë‹¤.

    System.out.println(Thread.currentThread().getName() + ": back in main");
    Thread.dumpStack();
    executor.shutdown();  // ë‹¤ ì“°ê³  ë‚˜ë©´ ExecutorServiceë¥¼ ì¢…ë£Œí•´ì•¼ í•œë‹¤.
  }
}
```
- Thread ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ëŒ€ì‹  Executors í´ë˜ìŠ¤ì— ìˆëŠ” ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ExecutorServiceë¥¼ ìƒì„±í•œë‹¤.


### ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬
- ëˆ„ê°€ ì‹¤í–‰ ì¤‘ì¸ ìƒíƒœì—ì„œ ì‹¤í–‰ ê°€ëŠ¥í•œ ìƒíƒœë¡œ ì›€ì§ì—¬ì•¼ í• ì§€, ì–¸ì œ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ ì¤‘ì¸ ìƒíƒœë¥¼ ë– ë‚˜ì•¼ í•˜ëŠ”ì§€ ë“±ì˜ ê²°ì •ì€ ëª¨ë‘ ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ë‚´ë¦°ë‹¤.
- ì›¬ë§Œí•˜ë©´ ê° ìŠ¤ë ˆë“œê°€ ê³µí‰í•˜ê²Œ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ ì¤€ë‹¤. (í™•ì‹¤í•˜ê²Œ ê·¸ë ‡ê²Œ ëœë‹¤ëŠ” ë³´ì¥ì€ ì—†ë‹¤.)
- ë‹¤ë¥¸ ìŠ¤ë ˆë“œëŠ” ëª¨ë‘ ì œì³ë‘ê³  í•œ ìŠ¤ë ˆë“œë§Œ ì§‘ì¤‘ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê²Œ í•˜ëŠ” ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ë„ ìˆì„ ìˆ˜ ìˆë‹¤.

### ìŠ¤ì¼€ì¤„ëŸ¬ì˜ ë¶ˆí™•ì‹¤ì„±ì„ ë³´ì—¬ì¤„ ìˆ˜ ìˆëŠ” ì˜ˆì œ
ì–´ë–¤ ì‹œìŠ¤í…œì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œì¼°ë”ë‹ˆ
```java
class ExecutorTestDrive {
  public static void main (String[] agrs) {
    ExecutorService executor = Executors.newSingleThreadExecutor();
    executor.execute(() -> System.out.println("top o' the stack"));  // ì‘ì—…ì´ í•œ ì¤„ë°–ì— ì•ˆë˜ê¸° ë•Œë¬¸ì— ëŒë‹¤ í‘œí˜„ì‹ ì“°ëŠ”ê²Œ ì¢‹ìŒ
    System.out.println("back in main");
    executor.shutdown();
  }
}
```
ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì™”ë‹¤.
```java
back in main
top o' the stack
-
top o' the stack
back in main
-
top o' the stack
back in main
-
back in main
top o' the stack
```
ì´ì²˜ëŸ¼ ìˆœì„œê°€ ì•„ë¬´ë ‡ê²Œë‚˜ ë°”ë€” ìˆ˜ ìˆë‹¤. ìƒˆ ìŠ¤ë ˆë“œê°€ ë¨¼ì € ëë‚  ìˆ˜ë„ ìˆê³  ë©”ì¸ ìŠ¤ë ˆë“œê°€ ë¨¼ì € ëë‚  ìˆ˜ë„ ìˆë‹¤.

### ê²°ê³¼ê°€ ë‹¤ë¥´ê²Œ ë‚˜ì˜¤ëŠ” ì´ìœ 
ë©€í‹°ìŠ¤ë ˆë“œ í”„ë¡œê·¸ë¨ì€ ê²°ì •ë¡ ì ì´ì§€ ì•Šë‹¤. ë§¤ë²ˆ ë˜‘ê°™ì€ ì‹ìœ¼ë¡œ ëŒì•„ê°€ì§€ ì•ŠëŠ” ê²ƒì„. ìŠ¤ë ˆë“œ ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ë§¤ë²ˆ í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ê° ìŠ¤ë ˆë“œ ì‹¤í–‰ ìŠ¤ì¼€ì¤„ì„ ë‹¤ë¥´ê²Œ ì§¤ ìˆ˜ ìˆë‹¤.

### ìŠ¤ë ˆë“œë¥¼ ëŒ€ê¸° ìƒíƒœë¡œ ì „í™˜ì‹œí‚¤ëŠ” ë°©ë²•
ìŠ¤ë ˆë“œë¥¼ ëŒ€ê¸° ìƒíƒœì— ì§‘ì–´ë„£ê³  ì‹¶ë‹¤ë©´ ì •ì  ë©”ì„œë“œì¸ sleep() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ë˜ëŠ”ë°, ì´ë•Œ ëŒ€ê¸° ì‹œê°„ì„ ë°€ë¦¬ì´ˆ(1/1,000ì´ˆ) ë‹¨ìœ„ë¡œ ì§€ì •í•˜ê¸° ìœ„í•œ ìˆ«ìë¥¼ ì¸ìë¡œ ì „ë‹¬í•´ì•¼ í•œë‹¤.
```java
Thread.sleep(2000);
```
ê·¸ëŸ°ë° sleep ë©”ì„œë“œì—ì„œ InterruptedExceptionì´ë¼ëŠ” í™•ì¸ ì˜ˆì™¸ë¥¼ ë˜ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— sleepì„ í˜¸ì¶œí•  ë•ŒëŠ” í•­ìƒ try/catchë¸”ë¡ ì•ˆì—ì„œ í˜¸ì¶œí•´ì•¼ í•œë‹¤.
```java
try {
  Thread.sleep(2000);
} catch(InterruptedException ex) {
  ex.printStackTrace();
}
```

### sleep()ì„ ì¨ì„œ ì‹¤í–‰ ê²°ê³¼ì˜ ì˜ˆì¸¡ì„±ì„ ë†’ì´ëŠ” ë°©ë²•
```java
class PredictableSleep {
  public static void main (String[] args) {
    ExecutorService executor = Executors.newSingleThreadExecutor();
    executor.execute(() -> sleepThenPrint());
    System.out.println("back in main");
    executor.shutdown();
  }

  private static void sleepThenPrint() {
    try {
      TimeUnit.SECONDS.sleep(2);
    } catch (InterruptedException e) {
      e.printStackTrace();
    }
    System.out.println("top o' the stack");
  }
}
```
ì¶œë ¥ ê²°ê³¼
```java
back in main
top o' the stack
-
back in main
top o' the stack
-
back in main
top o' the stack
-
back in main
top o' the stack
```
ì•„ê¹Œì™€ëŠ” ë‹¤ë¥´ê²Œ í•­ìƒ ê°™ì€ ìˆœì„œë¡œ ì‹¤í–‰ëœë‹¤.
